---
- name: Stop Prometheus before iptables setup
  ansible.builtin.systemd:
    name: prometheus.service
    state: stopped
  when: vpn_role == "main"
  ignore_errors: true
  register: ignore_errors_register

- name: Stop Grafana before iptables setup
  ansible.builtin.systemd:
    name: grafana.service
    state: stopped
  when: vpn_role == "main"
  ignore_errors: true
  register: ignore_errors_register

- name: Stop Docker before iptables setup
  ansible.builtin.systemd:
    name: docker.service
    state: stopped
  when: vpn_role == "main"
  ignore_errors: true
  register: ignore_errors_register

- name: Stop wg0 before iptables setup
  ansible.builtin.systemd:
    name: wg-quick@wg0.service
    state: stopped
  when: vpn_wg0 == "true"
  ignore_errors: true
  register: ignore_errors_register

- name: Stop wg1 before iptables setup
  ansible.builtin.systemd:
    name: wg-quick@wg1.service
    state: stopped
  ignore_errors: true
  register: ignore_errors_register

- name: Stop fail2ban before iptables setup
  ansible.builtin.systemd:
    name: fail2ban.service
    state: stopped
  ignore_errors: true
  register: ignore_errors_register
